---
// src/components/blog/AuthorBio.astro - Handle empty names
export interface Props {
  author: {
    name: string; // Required
    bio?: string | null; // Optional
    avatar?: string | null; // Optional
    role?: string | null; // Optional
    social?: {
      twitter?: string;
      linkedin?: string;
      github?: string;
      website?: string;
    } | null;
  };
}

const { author } = Astro.props;

// Don't render if no author or empty name
if (!author || !author.name || author.name.trim() === "") {
  return null;
}

// Helper function to check if social links exist and are not empty
const hasSocialLinks =
  author.social &&
  Object.values(author.social).some((link) => link && link.trim() !== "");
---

<div
  class="author-bio theme-bg-secondary theme-card p-6 rounded-sm theme-border mb-6"
  data-theme-aware="true"
>
  <div class="flex items-start space-x-4">
    {
      author.avatar && author.avatar.trim() !== "" && (
        <img
          src={author.avatar}
          alt={`${author.name} profile picture`}
          class="w-12 h-12 rounded-sm object-cover flex-shrink-0 border-2 theme-border"
          loading="lazy"
        />
      )
    }

    <div class="flex-1">
      <h3 class="text-lg font-semibold theme-text-primary mb-1">
        {author.name}
      </h3>

      {
        author.role && author.role.trim() !== "" && (
          <p class="text-sm theme-text-secondary mb-2">{author.role}</p>
        )
      }

      {
        author.bio && author.bio.trim() !== "" && (
          <p class="theme-text-secondary text-sm leading-relaxed mb-3">
            {author.bio}
          </p>
        )
      }

      {
        hasSocialLinks && (
          <div class="flex items-center gap-3">
            {author.social?.twitter && author.social.twitter.trim() !== "" && (
              <a
                href={author.social.twitter}
                target="_blank"
                rel="noopener noreferrer"
                class="theme-text-muted hover:text-blue-500 transition-colors"
                aria-label={`${author.name} on Twitter`}
              >
                <i class="fab fa-twitter w-4 h-4" />
              </a>
            )}

            {author.social?.linkedin &&
              author.social.linkedin.trim() !== "" && (
                <a
                  href={author.social.linkedin}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="theme-text-muted hover:text-blue-700 transition-colors"
                  aria-label={`${author.name} on LinkedIn`}
                >
                  <i class="fab fa-linkedin w-4 h-4" />
                </a>
              )}

            {author.social?.github && author.social.github.trim() !== "" && (
              <a
                href={author.social.github}
                target="_blank"
                rel="noopener noreferrer"
                class="theme-text-muted hover:text-gray-600 dark:hover:text-gray-300 transition-colors"
                aria-label={`${author.name} on GitHub`}
              >
                <i class="fab fa-github w-4 h-4" />
              </a>
            )}

            {author.social?.website && author.social.website.trim() !== "" && (
              <a
                href={author.social.website}
                target="_blank"
                rel="noopener noreferrer"
                class="theme-text-muted hover:text-green-600 transition-colors"
                aria-label={`${author.name}'s website`}
              >
                <i class="fas fa-globe w-4 h-4" />
              </a>
            )}
          </div>
        )
      }
    </div>
  </div>
</div>

<style>
  /* Theme-aware styles */
  .theme-card {
    background-color: var(--card-bg) !important;
    border-color: var(--card-border) !important;
  }

  .theme-bg-secondary {
    background-color: var(--color-bg-secondary) !important;
  }

  .theme-border {
    border-color: var(--color-border) !important;
  }

  .theme-text-primary {
    color: var(--color-text-primary) !important;
  }

  .theme-text-secondary {
    color: var(--color-text-secondary) !important;
  }

  .theme-text-muted {
    color: var(--color-text-muted) !important;
  }

  /* Ensure proper theme inheritance */
  .author-bio {
    transition: all 0.3s ease;
  }

  .theme-card {
    background-color: var(--card-bg) !important;
    border-color: var(--card-border) !important;
  }

  .theme-bg-secondary {
    background-color: var(--color-bg-secondary) !important;
  }

  .theme-border {
    border-color: var(--color-border) !important;
  }

  .theme-text-primary {
    color: var(--color-text-primary) !important;
  }

  .theme-text-secondary {
    color: var(--color-text-secondary) !important;
  }

  .theme-text-muted {
    color: var(--color-text-muted) !important;
  }

  .author-bio {
    transition: all 0.3s ease;
  }
</style>
