---
// src/pages/auth/admin-signout.astro - SIMPLE VERSION
---

<script>
  // Simple admin sign out
  async function performAdminSignOut() {
    try {
      console.log("üîÑ Signing out...");

      // Clear all storage immediately
      localStorage.clear();
      sessionStorage.clear();

      // Clear cookies
      document.cookie.split(";").forEach(function (c) {
        document.cookie = c
          .replace(/^ +/, "")
          .replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
      });

      console.log("‚úÖ Storage cleared");

      // Try to sign out from Supabase (but don't wait too long)
      try {
        const authModule = await import("../../lib/admin/auth.js");
        await authModule.adminAuthManager.signOut();
        console.log("‚úÖ Supabase sign out completed");
      } catch (error) {
        console.log("‚ö†Ô∏è Supabase sign out failed, continuing anyway");
      }

      // Redirect
      window.location.replace("/auth/admin-signin?message=signed_out");
    } catch (error) {
      console.error("‚ùå Sign out error:", error);
      // Force redirect even on error
      window.location.replace("/auth/admin-signin?message=signed_out");
    }
  }

  // Execute immediately
  performAdminSignOut();
</script>

<div
  style="display: flex; align-items: center; justify-content: center; min-height: 100vh; font-family: system-ui;"
>
  <div style="text-align: center;">
    <div style="font-size: 2rem; margin-bottom: 1rem;">üîÑ</div>
    <h2>Signing out...</h2>
    <p>Please wait...</p>
  </div>
</div>
