---
// src/pages/admin/index.astro - Let TinaCMS handle itself
const pathname = Astro.url.pathname;

// If this is the TinaCMS route, don't handle it - let the static file serve
if (pathname === "/admin/index.html") {
  // Return 404 to let Astro serve the static file from public/admin/index.html
  return new Response(null, { status: 404 });
}

// Only handle /admin (without .html) - redirect to dashboard
import { adminAuthManager } from "../../lib/admin/auth.js";

await adminAuthManager.initialize();
const user = await adminAuthManager.getCurrentUser();

if (!user) {
  return Astro.redirect("/auth/admin-signin");
}

return Astro.redirect("/admin/dashboard");
---
